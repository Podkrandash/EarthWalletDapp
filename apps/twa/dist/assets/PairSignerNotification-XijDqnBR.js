import{c as m,r as n,u as g,h,da as E,e_ as C,j as i,bJ as S,e$ as b,f0 as k,f1 as v,d as j,an as _}from"./index-DR6GvvU1.js";import{u as w}from"./navigate-V5vJ7JBi.js";const B=(s,t)=>{const o=m(),[e,a]=n.useState(s);return n.useEffect(()=>{e&&o.uiEvents.emit("scan",{method:"scan",id:e,params:void 0})},[e]),n.useEffect(()=>{const r=u=>{u.id===e&&t(u.params)};return o.uiEvents.on("response",r),()=>{o.uiEvents.off("response",r)}},[o,e,t]),n.useCallback(()=>{a(Date.now())},[a])},I=({sdk:s,boc:t,onClose:o,onSubmit:e,wallet:a})=>{const{t:r}=g(),{extension:u}=h();w(s,o);const c=B(null,e),f=n.useMemo(()=>{if(!E(a))throw new Error("Unexpected wallet");return C(a.publicKey,a.version,t)},[a,t]);return i.jsxs(S,{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c()},children:[i.jsx(b,{title:r("import_signer"),description:r("signer_scan_tx_description")}),i.jsx(k,{extension:u,margin:!0,children:i.jsx(v,{message:f})}),i.jsx(j,{primary:!0,size:"large",fullWidth:!0,type:"submit",children:r("signer_scan_result")})]})},A=()=>{const s=m(),[t,o]=n.useState(void 0),[e,a]=n.useState(void 0),[r,u]=n.useState(void 0),c=n.useCallback(()=>{o(void 0),a(void 0)},[]),f=n.useCallback(l=>{console.log(l),s.uiEvents.emit("response",{method:"response",id:e,params:l}),c()},[s,e,c]),d=n.useCallback(()=>{e&&s.uiEvents.emit("response",{method:"response",id:e,params:new Error("Cancel auth request")}),c()},[e,s,c]);n.useEffect(()=>{const l=p=>{o(p.params.boc),a(p.id),u(p.params.wallet)};return s.uiEvents.on("signer",l),()=>{s.uiEvents.off("signer",l)}},[s]);const x=n.useCallback(()=>{if(!(!t||!e||!r))return i.jsx(I,{sdk:s,boc:t,onClose:d,onSubmit:f,wallet:r})},[s,t,e,d,f,r]);return i.jsx(_,{isOpen:t!=null&&e!=null,handleClose:d,children:x})};export{I as SignerContent,A as default};
